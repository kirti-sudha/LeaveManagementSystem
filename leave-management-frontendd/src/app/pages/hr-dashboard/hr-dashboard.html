<div class="page-card">
  <div class="header">
    <h2 class="page-title">HR Leave Management</h2>
  </div>

  <!-- Filter & Action Controls -->
  <div class="controls-container">
    <div class="filter-controls">
      <input type="text" class="search-input" placeholder="Search by employee name..." [formControl]="searchControl">
      <select [formControl]="statusFilter" class="status-select">
        <option value="ALL">All Statuses</option>
        <option value="PENDING">Pending</option>
        <option value="APPROVED">Approved</option>
        <option value="REJECTED">Rejected</option>
        <option value="CANCELLED">Cancelled</option>
      </select>
    </div>
    <button class="btn btn-secondary" (click)="exportPdf()" [disabled]="isLoading || filteredLeaves.length === 0">
      Export Filtered as PDF
    </button>
  </div>
  
  <div *ngIf="isLoading" class="loading-indicator">Loading requests...</div>
  <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <!-- Leave Requests Table -->
  <div *ngIf="!isLoading" class="table-responsive">
    <div *ngIf="filteredLeaves.length > 0; else noLeavesTemplate">
      <table>
        <thead>
          <tr>
            <th>Employee Name</th>
            <th>Leave Type</th>
            <th>Dates</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let leave of filteredLeaves">
            <td>{{ leave.employeeName }}</td>
            <td>{{ leave.leaveType }}</td>
            <td>{{ leave.startDate | date: 'dd-MMM-yyyy' }} to {{ leave.endDate | date: 'dd-MMM-yyyy' }}</td>
            <td>
              <span class="status-badge" [ngClass]="'status-' + leave.status.toLowerCase()">{{ leave.status }}</span>
            </td>
            <td class="actions-cell">
              <ng-container *ngIf="leave.status === 'PENDING'; else noActions">
                <button class="btn btn-approve" (click)="handleAction('approve', leave.id)">Approve</button>
                <button class="btn btn-reject" (click)="handleAction('reject', leave.id)">Reject</button>
              </ng-container>
              <ng-template #noActions>
                <span>--</span>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <ng-template #noLeavesTemplate>
        <div class="no-data-message">
            <p>No leave requests match the current filters.</p>
        </div>
    </ng-template>
  </div>
</div>